<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Micro Focus Content Manager SDK 10.1: Programming in Content Manager</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygenBase.css" rel="stylesheet" type="text/css" />
<link href="doxyStylesheet.css" rel="stylesheet" type="text/css"/>
<link href="doxySidebarFixes.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="mf_logo_white_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Micro Focus Content Manager SDK 10.1
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('programming_guide.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Programming in Content Manager </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#programming_in">Introduction</a><ul><li class="level2"><a href="#main_objects">The main objects</a></li>
<li class="level2"><a href="#application_object">Using the TrimApplication object</a></li>
<li class="level2"><a href="#database_object">Using the Database object</a><ul><li class="level3"><a href="#autotoc_md118">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#database_pooling">Database pooling</a><ul><li class="level3"><a href="#autotoc_md119">Code Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#creating_records">Creating and modifying Records</a><ul><li class="level2"><a href="#new_record">Creating new Records</a><ul><li class="level3"><a href="#autotoc_md120">Code example</a></li>
</ul>
</li>
<li class="level2"><a href="#creating_records_container">Setting the Container and Classification</a></li>
<li class="level2"><a href="#access_existing_record">Accessing existing records</a></li>
<li class="level2"><a href="#get_existing_record">Getting a record by record number</a><ul><li class="level3"><a href="#autotoc_md121">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#record_by_uri">Getting a Record by URI</a><ul><li class="level3"><a href="#autotoc_md122">Code Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#reading_record_data">Reading record data</a><ul><li class="level2"><a href="#reading_basic_properties">Basic properties</a><ul><li class="level3"><a href="#autotoc_md123">Examples of basic readable properties of a record are:</a></li>
<li class="level3"><a href="#autotoc_md124">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#related_objects">Accessing related objects</a><ul><li class="level3"><a href="#autotoc_md125">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#record_Location_info">Accessing record Location information</a><ul><li class="level3"><a href="#autotoc_md126">Code Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#updating_records">Updating records</a><ul><li class="level2"><a href="#modifying_properties">Modifying properties</a><ul><li class="level3"><a href="#autotoc_md127">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#update_methods">Calling update methods</a><ul><li class="level3"><a href="#autotoc_md128">Code Example</a></li>
<li class="level3"><a href="#autotoc_md129">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#updating_properties">Updating properties using SetProperty</a><ul><li class="level3"><a href="#autotoc_md130">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#update_user_defined_fields">User Defined Fields</a><ul><li class="level3"><a href="#autotoc_md131">Code Example (GetFieldValue())</a></li>
<li class="level3"><a href="#autotoc_md132">Code Example (SetFieldValue())</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#Verifying_and_error_trapping">Verifying and error trapping</a><ul><li class="level2"><a href="#The_Verify_method">The Verify() method</a><ul><li class="level3"><a href="#autotoc_md133">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#The_Verified_property">The Verified property</a></li>
<li class="level2"><a href="#Trapping_run-time_errors">Trapping run-time errors</a></li>
<li class="level2"><a href="#Saving_the_record_to_the_database">Saving the record to the database</a></li>
</ul>
</li>
<li class="level1"><a href="#New_records_and_electronic_documents">New records and electronic documents</a><ul><li class="level2"><a href="#autotoc_md134">Creating a container file</a></li>
<li class="level2"><a href="#Creating_a_record_of_a_given_type">Creating a record of a given type</a></li>
<li class="level2"><a href="#Controlled_and_free_text_titling">Controlled and free text titling</a><ul><li class="level3"><a href="#autotoc_md135">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#Security_Levels_and_Caveats">Security Levels and Caveats</a><ul><li class="level3"><a href="#autotoc_md136">Code Example</a></li>
<li class="level3"><a href="#autotoc_md137">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#Record_Locations">Record Locations</a><ul><li class="level3"><a href="#autotoc_md138">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#Record_Contacts">Record Contacts</a><ul><li class="level3"><a href="#autotoc_md139">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#Creating_a_Document">Creating a Document</a></li>
<li class="level2"><a href="#Titling_and_numbering">Titling and numbering</a><ul><li class="level3"><a href="#autotoc_md140">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#Assigning_to_a_container">Assigning to a container</a><ul><li class="level3"><a href="#autotoc_md141">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#Attaching_an_electronic_document">Attaching an electronic document</a><ul><li class="level3"><a href="#autotoc_md142">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#Document_Author">Document Author</a></li>
</ul>
</li>
<li class="level1"><a href="#Locations">Locations</a><ul><li class="level2"><a href="#Working_with_Locations">Working with Locations</a></li>
<li class="level2"><a href="#Finding_a_Person_by_Name">Finding a Person by Name</a><ul><li class="level3"><a href="#autotoc_md143">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#Creating_a_new_Staff_Member">Creating a new Staff Member</a><ul><li class="level3"><a href="#autotoc_md144">Code Example</a></li>
<li class="level3"><a href="#autotoc_md145">Code Example</a></li>
<li class="level3"><a href="#autotoc_md146">Code Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#Searching_Content_Manager">Searching Content Manager using the .NET SDK</a><ul><li class="level2"><a href="#Searching_for_Records_Manager_objects">Searching for Content Manager objects</a><ul><li class="level3"><a href="#autotoc_md147">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#Specifying_the_search_criteria">Specifying the search criteria</a><ul><li class="level3"><a href="#autotoc_md148">Code Example</a></li>
<li class="level3"><a href="#autotoc_md149">Code Example</a></li>
</ul>
</li>
<li class="level2"><a href="#Retrieving_the_results">Retrieving the results of the search</a><ul><li class="level3"><a href="#autotoc_md150">Code Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#Other_search_features">Other search features</a><ul><li class="level2"><a href="#search_paged_results">Return paged results</a></li>
<li class="level2"><a href="#enum_filtering">Filtering/searching by enum value</a></li>
<li class="level2"><a href="#Purpose_filtering">Purpose filtering</a></li>
<li class="level2"><a href="#Persisting_a_search">Persisting a search</a></li>
<li class="level2"><a href="#autotoc_md151">Item matching</a></li>
<li class="level2"><a href="#search_count">Result counts</a></li>
<li class="level2"><a href="#sort_by_field">Sorting by User Defined Fields</a></li>
</ul>
</li>
<li class="level1"><a href="#stream_search">Stream searching</a><ul><li class="level2"><a href="#example_stream_search">Example</a></li>
<li class="level2"><a href="#example_stream_search_json">Sample JSON</a></li>
</ul>
</li>
<li class="level1"><a href="#document_integrity_checker">Document integrity checker</a><ul><li class="level2"><a href="#example_running_document_store_integrity_check">Example: Running Document Store Integrity Check</a></li>
</ul>
</li>
<li class="level1"><a href="#change_notifications">Global object change notifications</a><ul><li class="level2"><a href="#example_change_notifications">Example</a></li>
</ul>
</li>
<li class="level1"><a href="#wgs_progress_notifications">Progress notifications while communicating with a workgroup server</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_doc_20___Programming"></a></p>
<h1><a class="anchor" id="programming_in"></a>
Introduction</h1>
<h2><a class="anchor" id="main_objects"></a>
The main objects</h2>
<p>The .NET SDK has a number of important base classes, from which most SDK objects are derived from. These base classes are:</p>
<ul>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_object.html">TrimObject</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">TrimMainObject</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_child_object.html">TrimChildObject</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_child_object_list.html">TrimChildObjectList</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html">TrimMainObjectSearch</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_property_set.html">TrimPropertySet</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_user_option_set.html">TrimUserOptionSet</a></li>
<li><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_search_stack_item.html">TrimSearchStackItem</a></li>
</ul>
<p>Most objects in the .NET SDK have their own constructors and can be created directly.</p>
<p>If while programming an SDK-based application you are unsure about how to perform a specific Content Manager function, it is often helpful to see how the function is performed in the Content Manager Client.</p>
<h2><a class="anchor" id="application_object"></a>
Using the TrimApplication object</h2>
<p>The <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_application.html">TrimApplication</a> class has methods and properties which describe and adjust the environment which your application is running in. Two important methods are:</p><ul>
<li><code>TrimApplication.Initialize()</code> – As previously mentioned.</li>
<li><code>TrimApplication.RuntimeEnvironment</code> = <a class="el" href="namespace_t_r_i_m_1_1_s_d_k.html#a183104559534143f4142e0bb5a27cf8b">Environments</a>. This tells Content Manager what the runtime environment of the application is. Content Manager will then make changes to its behavior necessary for that environment.</li>
</ul>
<h2><a class="anchor" id="database_object"></a>
Using the Database object</h2>
<p>The <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_database.html">Database</a> class maintains a session connection to a Content Manager Workgroup Server. You will normally have to construct a <code>Database</code> object before you can construct any other SDK object.</p>
<p>The <code>Database</code> object has a default constructor, allowing a new instance to be created by using the .NET <code>new</code> keyword. Before connecting the <code>Database</code> object by calling <code>Database.Connect()</code>, you should specify the dataset ID of the database to use, and the network address of the Workgroup Server to connect to. If these properties are not set, the defaults for the currently logged in user are used.</p>
<h3><a class="anchor" id="autotoc_md118"></a>
Code Example</h3>
<div class="fragment"><div class="line"><span class="keyword">using</span> (<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a> objDB = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a>())</div>
<div class="line">{</div>
<div class="line">    objDB.Id = <span class="stringliteral">&quot;PD&quot;</span>;                            <span class="comment">// every Content Manager Database has a two character id</span></div>
<div class="line">    objDB.WorkgroupServerName = <span class="stringliteral">&quot;local&quot;</span>;</div>
<div class="line">    objDB.Connect();                            <span class="comment">// throws an exception if the connection fails</span></div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">TRIM.SDK.BaseObjectTypes.Database</a></div><div class="ttdeci">@ Database</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="database_pooling"></a>
Database pooling</h2>
<p>The <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_database_connection_pool.html">DatabaseConnectionPool</a> enables the reuse of database connections, to reduce overhead in multi-user applications, such as web services. Only a single instance should be instantiated in a process, and once this has been done, <code>Database</code> objects may be instantiated in exactly the same way as before, with the database pool operational in the background.</p>
<p>In the sample code below, the addition of the <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_database_connection_pool.html">DatabaseConnectionPool</a> reduces the response time for subsequent connections to less than 3 milliseconds.</p>
<h3><a class="anchor" id="autotoc_md119"></a>
Code Example</h3>
<div class="fragment"><div class="line"><span class="keyword">using</span> (var connectionPool = <span class="keyword">new</span> DatabaseConnectionPool())</div>
<div class="line">{</div>
<div class="line">    connectionPool.MaxConnectionCount = 1;</div>
<div class="line">    connectionPool.MaxConnectionAge = 20 * 60 * 60;</div>
<div class="line">    var watch = <span class="keyword">new</span> Stopwatch();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> counter = 0; counter &lt; 10; counter++)</div>
<div class="line">    {</div>
<div class="line">        watch.Reset();</div>
<div class="line">        watch.Start();</div>
<div class="line">        <span class="keyword">using</span> (<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a> database = getDatabase(<span class="stringliteral">&quot;david&quot;</span>))</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// ...</span></div>
<div class="line">        }</div>
<div class="line">        watch.Stop();</div>
<div class="line">        Console.WriteLine(watch.ElapsedMilliseconds);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <blockquote class="doxtable">
<p><b>Note:</b> In a real application, you would instantiate the database pool at some point during application startup, for example in a static constructor in the class that manages <code>Database</code> connections. </p>
</blockquote>
<h1><a class="anchor" id="creating_records"></a>
Creating and modifying Records</h1>
<h2><a class="anchor" id="new_record"></a>
Creating new Records</h2>
<p>Before creating a new <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_record.html">Record</a> you need to load a <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_record_type.html">RecordType</a> object which specifies the type of record you are creating. After creating a record or changing an existing record you need to save it.</p>
<h3><a class="anchor" id="autotoc_md120"></a>
Code example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div>
<div class="line"><span class="comment">// You will need to modify the records properties</span></div>
<div class="line">objRec.Save();</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">TRIM.SDK.BaseObjectTypes.Record</a></div><div class="ttdeci">@ Record</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">TRIM.SDK.AlertConditionTypes.RecordType</a></div><div class="ttdeci">@ RecordType</div><div class="ttdoc">For Records that have a Record Type of</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="creating_records_container"></a>
Setting the Container and Classification</h2>
<p>When creating a new record many of the default settings are obtained from the record type. Because you need to specify the record type in the constructor, if you override these defaults in your code the meaning is obvious and the new value is respected. There are two other key properties that can also have similar side effects in the setting of default values. When you set the Classification or Container property, there are settings on the classification or container record that are meant to override the defaults on the record type. They are not meant to override settings you make specifically in your code, however avoiding that consequence is always reliable. For example, if you set the container before the classification, the defaults on the classification may override the defaults associated with the container, which may not be what you want (or what the records manager wants). To avoid these sort of issues, it is recommended that you set the Classification and Container properties first (and in that order) before setting any other properties when creating a new record. Note that the ServiceAPI does this automatically, this advice applies only to code that is using the Content Manager .NET SDK.</p>
<h2><a class="anchor" id="access_existing_record"></a>
Accessing existing records</h2>
<p>To read information stored on records in an Content Manager database, the SDK programmer must first determine how to access the records required. If a particular record’s internal or external unique identifier is known, the associated record can be accessed directly and efficiently using the <code>Record</code> constructor. If neither of these unique identifiers is known, it will be necessary to construct a search.</p>
<h2><a class="anchor" id="get_existing_record"></a>
Getting a record by record number</h2>
<p>Every Record in Content Manager has a unique record number. This follows a pattern defined by the record type and can be manually entered by the user or set to be automatically generated by Content Manager. Although the commonly used term is ‘number’, it is more correctly an identifier, as it is a string that may contain alphanumeric characters. This string is accessible through the <code>Record.Number</code> property.</p>
<p>The record number can be used as a string argument when creating <code>Record</code> objects.</p>
<h3><a class="anchor" id="autotoc_md121"></a>
Code Example</h3>
<div class="fragment"><div class="line"><span class="comment">// This statement instantiates Record 2015/0059 by expanded record number</span></div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRecord = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;2015/0059&quot;</span>);</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>Note:</b> Content Manager stores the record number in two formats, expanded (e.g. "2015/0059") and compressed (e.g. "15/59"). Either can be substituted above. </p>
</blockquote>
<h2><a class="anchor" id="record_by_uri"></a>
Getting a Record by URI</h2>
<p>The Unique Row Identifier or URI of a record is an internal unique number that is transparent to the everyday user of Content Manager. It is the primary key on the <code>TSRECORD</code> table in the database and provides an internal unique identifier for every record. Similarly to the record number, the record URI can be used as an argument when creating <code>Record</code> objects.</p>
<h3><a class="anchor" id="autotoc_md122"></a>
Code Example</h3>
<div class="fragment"><div class="line"><span class="comment">// This statement instantiates a record by its URI</span></div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRecord = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, 130);</div>
</div><!-- fragment --><p>Once a <code>Record</code> object has been created, the programmer can access properties and call methods on the object. These are discussed in the following subsections.</p>
<h1><a class="anchor" id="reading_record_data"></a>
Reading record data</h1>
<h2><a class="anchor" id="reading_basic_properties"></a>
Basic properties</h2>
<p>Most of the metadata directly associated with a record is exposed through properties on the <code>Record</code> object. Most properties return primitive data types (strings, numbers or dates) and can be interrogated directly. The meanings of these properties are generally self-evident from their names, but are also given in the object browser.</p>
<h3><a class="anchor" id="autotoc_md123"></a>
Examples of basic readable properties of a record are:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Property   </th><th class="markdownTableHeadNone">Example Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Number</code>   </td><td class="markdownTableBodyNone">"G1997/0770"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Title</code>   </td><td class="markdownTableBodyNone">"Greenhouse Journal of Global Warming - Dugong Habitats"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>DateCreated</code>   </td><td class="markdownTableBodyNone">8/20/1997    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ExternalId</code>   </td><td class="markdownTableBodyNone">"GJGW 97PB"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>AccessionNumber</code>   </td><td class="markdownTableBodyNone">5617   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md124"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> ((objRec.AccessionNumber &gt; 5000) &amp;&amp;</div>
<div class="line">    (objRec.DateCreated &lt; TrimDateTime.Parse(<span class="stringliteral">&quot;01/01/2000&quot;</span>)))</div>
<div class="line">{</div>
<div class="line">    MessageBox.Show(objRec.Title, <span class="stringliteral">&quot;Record &quot;</span> + objRec.Number.ToString());</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="related_objects"></a>
Accessing related objects</h2>
<p>Many properties of a <code>Record</code> represent other objects, such as the <code>Record.RecordType</code>, <code>Record.Classification</code> and <code>Record.Container</code> properties. These are properties where the data type of the property is an object.</p>
<h3><a class="anchor" id="autotoc_md125"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objCont = objRec.Container;</div>
<div class="line">MessageBox.Show(objCont.Number.ToString());</div>
</div><!-- fragment --> <h2><a class="anchor" id="record_Location_info"></a>
Accessing record Location information</h2>
<p>A <code>Record</code> has various properties concerning related location information. These properties of a <code>Record</code> all return an instantiated <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_location.html">Location</a> object:</p><ul>
<li><code>HomeLocation</code> – normal location of the record</li>
<li><code>OwnerLocation</code> – location of the owner or responsible unit for the record</li>
<li><code>Author</code> – person who authored the electronic document</li>
<li><code>Creator</code> – person who registered the record in Content Manager</li>
<li><code>Addressee</code> – person to whom the record is addressed</li>
<li><code>PrimaryContact</code> – the main contact person (or organization) for the record</li>
</ul>
<h3><a class="anchor" id="autotoc_md126"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>); <span class="comment">// get the record</span></div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a> objLoc = objRec.Author; <span class="comment">// get the author location object</span></div>
<div class="line">MessageBox.Show(<span class="stringliteral">&quot;Author’s name is: &quot;</span> + objLoc.FullFormattedName);</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">TRIM.SDK.BaseObjectTypes.Location</a></div><div class="ttdeci">@ Location</div></div>
</div><!-- fragment --> <h1><a class="anchor" id="updating_records"></a>
Updating records</h1>
<p>So far we have only considered the methods for reading information from records in Content Manager. The SDK also allows you to update Content Manager records, either by updating the values of properties on a given <code>Record</code> object, or by calling methods on the <code>Record</code>.</p>
<p>Updating properties is the simplest way to modify the metadata of a record. You simply assign a new value of the correct data type to the named property of the object. Field-level verification is carried out, and an error will be raised if the property update is invalid (see also the section on ‘Verifying’ below).</p>
<p>For more complicated types of update to a record, you must generally call methods that instruct Content Manager to modify the record, based on arguments passed.</p>
<h2><a class="anchor" id="modifying_properties"></a>
Modifying properties</h2>
<p>The simplest way to update data in a Content Manager record is to modify the named properties on the <code>Record</code> object. This can only be done on properties that are not marked as read-only. This includes most of the <code>DateTime</code> properties, certain <code>Location</code> properties (<code>Author</code>, <code>Addressee</code> and <code>OtherContact</code>) and miscellaneous properties such as <code>ExternalReference</code>, <code>Priority</code>, <code>AccessionNumber</code> and <code>ForeignBarcode</code>.</p>
<h3><a class="anchor" id="autotoc_md127"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = (<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>)objDB.FindTrimObjectByName(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record, <span class="stringliteral">&quot;D15/2&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (objRec != <span class="keyword">null</span>)</div>
<div class="line">{</div>
<div class="line">    objRec.TypedTitle = <span class="stringliteral">&quot;New title for this record&quot;</span>;</div>
<div class="line">    objRec.DateDue = <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a3bb14cd64ba102107ece7d22e656c1a2a8cf10d2341ed01492506085688270c1e">DateTime</a>.Today.AddDays(7); <span class="comment">//Due in 7 days</span></div>
<div class="line">    objRec.DatePublished = <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a3bb14cd64ba102107ece7d22e656c1a2a8cf10d2341ed01492506085688270c1e">DateTime</a>.Today;</div>
<div class="line">    objRec.Author = objDB.CurrentUser;</div>
<div class="line">    objRec.Save();</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">TRIM.SDK.BaseObjectTypes</a></div><div class="ttdeci">BaseObjectTypes</div><div class="ttdoc">The BaseObjectTypes enum</div><div class="ttdef"><b>Definition:</b> BaseObjectTypes.cs:16</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a3bb14cd64ba102107ece7d22e656c1a2a8cf10d2341ed01492506085688270c1e"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a3bb14cd64ba102107ece7d22e656c1a2a8cf10d2341ed01492506085688270c1e">TRIM.SDK.PropertySortMode.DateTime</a></div><div class="ttdeci">@ DateTime</div><div class="ttdoc">Date And Time</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="update_methods"></a>
Calling update methods</h2>
<p>To update other data on a record where read-write properties are not available, you must call a method instead. Update methods often begin with the prefix <code>Set...</code> and they include a parameter for the new data value you wish to apply.</p>
<h3><a class="anchor" id="autotoc_md128"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>); <span class="comment">// get the record</span></div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a> objCreator = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Peter Abbott&quot;</span>); <span class="comment">// get the location</span></div>
<div class="line">objRec.SetCreatorLocation(objCreator); <span class="comment">// set the creator</span></div>
<div class="line">objRec.Save();</div>
</div><!-- fragment --><p> In many cases other parameters can be specified that control the behavior of the update:</p>
<h3><a class="anchor" id="autotoc_md129"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>); <span class="comment">// get the record</span></div>
<div class="line">objRec.SetAssignee(objDB.CurrentUser, <span class="keyword">null</span>, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a3bb14cd64ba102107ece7d22e656c1a2a8cf10d2341ed01492506085688270c1e">DateTime</a>.Today.AddDays(-1)); <span class="comment">// set the Assignee</span></div>
<div class="line">objRec.Save();</div>
</div><!-- fragment --> <h2><a class="anchor" id="updating_properties"></a>
Updating properties using SetProperty</h2>
<p>To update a record’s properties where the internal identifier of the property is known, you can use the <code>SetProperty()</code> method. This requires passing the property identifier and a variant containing the data value.</p>
<h3><a class="anchor" id="autotoc_md130"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>); <span class="comment">// get the record</span></div>
<div class="line">objRec.SetProperty(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#ac89cda7c5437633dc79a88c21e468394">PropertyIds</a>.RecordTitle, <span class="stringliteral">&quot;New Title&quot;</span>); <span class="comment">// Set the title</span></div>
<div class="line">objRec.Save();</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_ac89cda7c5437633dc79a88c21e468394"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#ac89cda7c5437633dc79a88c21e468394">TRIM.SDK.PropertyIds</a></div><div class="ttdeci">PropertyIds</div><div class="ttdoc">The PropertyIds enum</div><div class="ttdef"><b>Definition:</b> PropertyIds.cs:16</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="update_user_defined_fields"></a>
User Defined Fields</h2>
<p>Content Manager allows user-defined fields to be assigned to records. These user-defined fields cannot be interrogated using normal named properties of the record object. Instead, accessing user defined fields is carried out using a dedicated object for managing these fields - the <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_field_definition.html">FieldDefinition</a> object. Each SDK object implementing the <a class="el" href="interface_t_r_i_m_1_1_s_d_k_1_1_i_trim_user_fields.html">ITrimUserFields</a> interface has a pair of methods for manipulating user-defined fields, <code>GetFieldValue()</code> and <code>SetFieldValue()</code>. Each method takes a populated <code>FieldDefinition</code> object as a parameter.</p>
<h3><a class="anchor" id="autotoc_md131"></a>
Code Example (GetFieldValue())</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a34d3d8ee3e60cdc3e6cd524705fdedba">FieldDefinition</a> fdDocType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a34d3d8ee3e60cdc3e6cd524705fdedba">FieldDefinition</a>(objDB, <span class="stringliteral">&quot;Document Type*&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a51d209f82894614c8958852b86f981d6a97427013ed5e27f28073c25dc0535345">UserFieldValue</a> ufvDocType = objRec.GetFieldValue(fdDocType);</div>
<div class="line">MessageBox.Show(ufvDocType.ToString());</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650a34d3d8ee3e60cdc3e6cd524705fdedba"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a34d3d8ee3e60cdc3e6cd524705fdedba">TRIM.SDK.BaseObjectTypes.FieldDefinition</a></div><div class="ttdeci">@ FieldDefinition</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a51d209f82894614c8958852b86f981d6a97427013ed5e27f28073c25dc0535345"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a51d209f82894614c8958852b86f981d6a97427013ed5e27f28073c25dc0535345">TRIM.SDK.LocationPurpose.UserFieldValue</a></div><div class="ttdeci">@ UserFieldValue</div><div class="ttdoc">User-defined Field Value</div></div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md132"></a>
Code Example (SetFieldValue())</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>);</div>
<div class="line">FieldDefinitionList udfs = objRec.RecordType.UserFields;</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a51d209f82894614c8958852b86f981d6a97427013ed5e27f28073c25dc0535345">UserFieldValue</a> ufvCurrent = <span class="keyword">null</span>;</div>
<div class="line"><span class="keywordflow">foreach</span> (FieldDefinition udf <span class="keywordflow">in</span> udfs)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span> (udf.Format)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a263264eabdf75f6f843ac0e6a9fa5922">UserFieldFormats</a>.Datetime:</div>
<div class="line">            TrimDateTime tdta = <span class="keyword">new</span> TrimDateTime(<span class="stringliteral">&quot;2015-01-01&quot;</span>);</div>
<div class="line">            ufvCurrent = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a51d209f82894614c8958852b86f981d6a97427013ed5e27f28073c25dc0535345">UserFieldValue</a>(tdta);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a263264eabdf75f6f843ac0e6a9fa5922">UserFieldFormats</a>.String:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a263264eabdf75f6f843ac0e6a9fa5922">UserFieldFormats</a>.Text:</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a263264eabdf75f6f843ac0e6a9fa5922">UserFieldFormats</a>.Xml:</div>
<div class="line">            ufvCurrent = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a51d209f82894614c8958852b86f981d6a97427013ed5e27f28073c25dc0535345">UserFieldValue</a>(<span class="stringliteral">&quot;Freddy&quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="comment">// ...</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (ufvCurrent != <span class="keyword">null</span>)</div>
<div class="line">    {</div>
<div class="line">        objRec.SetFieldValue(udf, ufvCurrent);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line">objRec.Save();</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a263264eabdf75f6f843ac0e6a9fa5922"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a263264eabdf75f6f843ac0e6a9fa5922">TRIM.SDK.UserFieldFormats</a></div><div class="ttdeci">UserFieldFormats</div><div class="ttdoc">Additional Field Formats</div><div class="ttdef"><b>Definition:</b> UserFieldFormats.cs:16</div></div>
</div><!-- fragment --> <h1><a class="anchor" id="Verifying_and_error_trapping"></a>
Verifying and error trapping</h1>
<p>When a <code>Record</code> object is modified via the SDK, there are two levels of verification that must be carried out before the changes can be committed to the database.</p>
<p>The first is field-level verification, which checks that the change to an individual property is legal. An example would be that the <code>DateRegistered</code> property is not in the future. If a property update cannot be carried out because of field-level verification, the method call or property assignment will cause a run-time error to be raised and the update will not be carried out.</p>
<p>The second level of verification is object-level verification (sometimes called cross-field verification). This checks that the values of all fields on the object are consistent with each other. An example of object-level verification would be that the <code>DateRegistered</code> property is not earlier than the <code>DateCreated</code> property. Object-level verification is performed when the object’s <code>Verify()</code> or <code>Save()</code> methods are called.</p>
<h2><a class="anchor" id="The_Verify_method"></a>
The Verify() method</h2>
<p>All main objects (i.e. objects derived from <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">TrimMainObject</a>) have a <code>Verify()</code> method. This can be called to perform object-level verification prior to saving the object. The method returns false if there are any errors in the state of the object, and the error description will be stored in the object’s <code>ErrorMessage</code> property. If there are no errors, the method returns true and the <code>Verified</code> property (see below) is set to true. The method contains an optional parameter <code>failOnWarning</code> which, if set to true, will cause the <code>Verify()</code> method to check for warning conditions as well as error conditions, and to fail if a warning is encountered.</p>
<h3><a class="anchor" id="autotoc_md133"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, <span class="stringliteral">&quot;G97/770&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (objRec.Verify(<span class="keyword">true</span>))</div>
<div class="line">{</div>
<div class="line">    MessageBox.Show(objRec.ErrorMessage, <span class="stringliteral">&quot;Verify Failed&quot;</span>);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    objRec.Save();</div>
<div class="line">}</div>
</div><!-- fragment --><p> If it is not called explicitly in code, the <code>Verify()</code> method will be automatically called before an object is saved (see below) and if verification fails it will not be saved. This ensures that data cannot become corrupted and that business rules are observed when using the SDK, just as they are for users of the Content Manager Client interface.</p>
<h2><a class="anchor" id="The_Verified_property"></a>
The Verified property</h2>
<p>All main objects also have a <code>Verified</code> Boolean read-only property, which is false whenever the object is instantiated. It is set to true when the <code>Verify()</code> method confirms that it is in a legal state to be saved to the database (regardless of warning conditions).</p>
<h2><a class="anchor" id="Trapping_run-time_errors"></a>
Trapping run-time errors</h2>
<p>It is up to the programmer to determine how they wish to deal with possible errors when updating an object. However, they must be aware that error checking takes place even when directly updating properties, so it will be necessary to provide some error-trapping code to prevent run-time errors being displayed to the user if there is a possibility of errors being raised.</p>
<h2><a class="anchor" id="Saving_the_record_to_the_database"></a>
Saving the record to the database</h2>
<p>All of the update methods and property changes made through the <code>Record</code> interface are only applied to the object in memory. The changes are not committed on the Content Manager database until the object is saved. Calling the <code>Save()</code> method on the record object will commit the changes to the database, applying all updates since the object was instantiated (or since it was last saved). Note that if the record has not been verified, <code>Save()</code> will automatically call the <code>Verify()</code> method and will only commit the changes if the verification succeeds. Various code examples using this method can be found throughout this document.</p>
<h1><a class="anchor" id="New_records_and_electronic_documents"></a>
New records and electronic documents</h1>
<h2><a class="anchor" id="autotoc_md134"></a>
Creating a container file</h2>
<p>This scenario describes the general processes for using the SDK to create a record of a generic record type we are calling a ‘Container File’.</p>
<p>In this and the next scenario (Creating a Document) we are assuming that the reader is familiar with the concept of record types. While it is up to the administrator of each Content Manager implementation to determine the record types to be used, it is typical to follow a standard records management practice of having at least two record types, one representing container files (or folders) and one representing documents (the actual names used for the record types may of course vary).</p>
<p>Container files are usually created and maintained by specialist records managers, as it is generally at this level that classification systems, retention schedules, security, keywords, controlled titling and other records management metadata are applied. Documents, on the other hand, are usually created by end-users, and require little specific metadata, other than the identification of the appropriate container file to which the document belongs, as all other metadata and context is inherited from the Container.</p>
<p>The general steps for creating a new container file record are as follows:</p>
<ol type="1">
<li>Instantiate the appropriate <code>RecordType</code> object</li>
<li>Instantiate a new <code>Record</code> object of this type</li>
<li>Identify the <code>Classification</code> or keywords for titling the record (optional)</li>
<li>Set the free text title</li>
<li>Assign security levels and caveats (optional)</li>
<li>Relate the record to associated Locations (optional)</li>
<li>Relate to other Records (optional)</li>
<li>Assign other metadata or user-defined fields (optional)</li>
<li>Assign a Record identifier</li>
<li>Save the <code>Record</code> object</li>
</ol>
<h2><a class="anchor" id="Creating_a_record_of_a_given_type"></a>
Creating a record of a given type</h2>
<p>When creating any record, the <code>RecordType</code> for the new record must be identified. This is passed to the record object’s constructor along with the <code>Database</code> which the new record is to belong to. See the <a class="el" href="programming_guide.html#new_record">Creating new records example</a>.</p>
<blockquote class="doxtable">
<p><b>Note:</b> It is possible to create new Record Types using the SDK; however, this is not recommended as this is generally an administrator’s function only. </p>
</blockquote>
<h2><a class="anchor" id="Controlled_and_free_text_titling"></a>
Controlled and free text titling</h2>
<p>Titles for container files are often subject to controlled vocabulary or classification structures such as a thesaurus or file plan, which give records managers’ greater control over file creation, retrieval and retention. Even when such controlled titling is used, each file will typically also have a ‘free text’ title part. The titling method used is determined by the record type, and is usually set by the Records Manager administrator. Thus a record with Classification titling may have a title such as: "Insurance – Property – Storm damage to Mackay information center", where the first two terms are generated from a predefined hierarchical classification structure and the remaining part of the title is ‘free text’ describing the specifics of the file. The generated title terms are determined by the classification codes, usually defined as a numerical sequence, such as "610/600/". The free text title is set via the <code>TypedTitle</code> property.</p>
<h3><a class="anchor" id="autotoc_md135"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;TestingClass&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div>
<div class="line"><span class="keywordflow">if</span> (objRecType.TitlingMethod == <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a256b845e706c60d93343db47ed796cad">TitlingMethods</a>.Classification)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Assign classification of 610/600/ = Insurance - Property</span></div>
<div class="line">    objRec.Classification = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a5c9335b28e6277ddbe0137f04e5e58a7">Classification</a>(objDB, <span class="stringliteral">&quot;610/600/&quot;</span>);</div>
<div class="line">    objRec.TypedTitle = <span class="stringliteral">&quot;Storm damage to Mackay information center&quot;</span>;</div>
<div class="line">    MessageBox.Show(objRec.GeneratedTitle); <span class="comment">// &quot;Insurance - Property&quot;</span></div>
<div class="line">}</div>
<div class="line">objRec.Save();</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a256b845e706c60d93343db47ed796cad"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a256b845e706c60d93343db47ed796cad">TRIM.SDK.TitlingMethods</a></div><div class="ttdeci">TitlingMethods</div><div class="ttdoc">Titling Methods</div><div class="ttdef"><b>Definition:</b> TitlingMethods.cs:16</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a9a91a6f03e7107a92af44bdd2092ca45a5c9335b28e6277ddbe0137f04e5e58a7"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a5c9335b28e6277ddbe0137f04e5e58a7">TRIM.SDK.AlertConditionTypes.Classification</a></div><div class="ttdeci">@ Classification</div><div class="ttdoc">For Records that have a Classification of</div></div>
</div><!-- fragment --><p> Similarly, Thesaurus or Keyword titling allows a file to be titled using either a choice of individual keywords from a controlled list or a specific ‘branch’ of related terms according to a hierarchical structure (similar to a record plan or classification).</p>
<h2><a class="anchor" id="Security_Levels_and_Caveats"></a>
Security Levels and Caveats</h2>
<p>The security profile of an individual Content Manager record is governed by three security controls: a Security Level, a set of zero or more Caveats, and Access Control. Security Levels and Caveats determine the access that a Content Manager user has to the metadata of a record. These security specifications are usually applied to Record Types (and inherited by records of each type when they are created) but can be set explicitly on individual records. Every user has a maximum Security Level and zero or more Caveats . In order to access a particular record, the user must have the same or a higher Security Level and must have all the Caveats associated with the record.</p>
<p>There are two ways to assign Security Levels and Caveats to a record via the SDK. If the value and number of Levels and Caveats are fixed then this method can be used.</p>
<h3><a class="anchor" id="autotoc_md136"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div>
<div class="line">objRec.Security = <span class="stringliteral">&quot;Confidential, Caveat1, Caveat2&quot;</span>;</div>
<div class="line">objRec.TypedTitle = <span class="stringliteral">&quot;Security Profile Example&quot;</span>;</div>
<div class="line">objRec.Save();</div>
</div><!-- fragment --><p> The more preferred way (although more verbose) is to retrieve the Security Level and Caveats, add them to a Security Profile and assign the Security Profile to the record. Both the <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_security_level.html">SecurityLevel</a> object and the <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_security_caveat.html">SecurityCaveat</a> objects can be instantiated by full name or by abbreviation. The instantiated <code>SecurityLevel</code> object can then be assigned to a <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_security_profile.html">TrimSecurityProfile</a>’s <code>SecurityLevel</code> property. Each instantiated <code>SecurityCaveat</code> object can be added via the <code>TrimSecurityProfile.AddCaveat()</code> method. The <code>TrimSecurityProfile</code> can then be assigned to a record’s <code>SecurityProfile</code> property.</p>
<h3><a class="anchor" id="autotoc_md137"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650af3447fcb20374e5b7d409751ec8cf7a3">SecurityLevel</a> secLevel = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650af3447fcb20374e5b7d409751ec8cf7a3">SecurityLevel</a>(objDB, <span class="stringliteral">&quot;Unclassified&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a72982940d5bb8a205ce8df099b4e6f68">SecurityCaveat</a> secCaveat1 = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a72982940d5bb8a205ce8df099b4e6f68">SecurityCaveat</a>(objDB, <span class="stringliteral">&quot;Caveat1&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a72982940d5bb8a205ce8df099b4e6f68">SecurityCaveat</a> secCaveat2 = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a72982940d5bb8a205ce8df099b4e6f68">SecurityCaveat</a>(objDB, <span class="stringliteral">&quot;Caveat2&quot;</span>);</div>
<div class="line">TrimSecurityProfile secProfile;</div>
<div class="line">secProfile = objRec.SecurityProfile;</div>
<div class="line">secProfile.SecurityLevel = secLevel;</div>
<div class="line">secProfile.AddCaveat(secCaveat1);</div>
<div class="line">secProfile.AddCaveat(secCaveat2);</div>
<div class="line">objRec.SecurityProfile = secProfile;</div>
<div class="line">objRec.TypedTitle = <span class="stringliteral">&quot;Security Profile Example&quot;</span>;</div>
<div class="line">objRec.Save();</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650a72982940d5bb8a205ce8df099b4e6f68"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a72982940d5bb8a205ce8df099b4e6f68">TRIM.SDK.BaseObjectTypes.SecurityCaveat</a></div><div class="ttdeci">@ SecurityCaveat</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650af3447fcb20374e5b7d409751ec8cf7a3"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650af3447fcb20374e5b7d409751ec8cf7a3">TRIM.SDK.BaseObjectTypes.SecurityLevel</a></div><div class="ttdeci">@ SecurityLevel</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="Record_Locations"></a>
Record Locations</h2>
<p>Defining relationships between a container file and location objects (people and places), provides additional and useful context for the record. Unlike record relationships, which can be user-defined, you can only use Content Manager’s predefined standard relationship types for record locations.</p>
<p>Record Locations represent actual (in the case of paper and other physical records) or logical (in the case of electronic records) places where a record resides. Every record in Content Manager has a property representing its Home Location (where the record should normally be). There is also a property for Owner Location – the exact meaning of this can vary according to the practices of each Content Manager implementation, but normally represents the person or body that is responsible for the record.</p>
<p>The Home Location and Owner Location of a record are typically derived from the default values for each Record Type, but all record location properties can be set on creation of a new record, or modified later. The <code>Record</code> object has methods for setting or changing the value of these location properties, which allow the option of specifying the date and time of the change of location (the default is the current time).</p>
<h3><a class="anchor" id="autotoc_md138"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a> objLocation = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Administration&quot;</span>);</div>
<div class="line">objRec.SetHomeLocation(objLocation);</div>
<div class="line">objRec.Save();</div>
</div><!-- fragment --> <h2><a class="anchor" id="Record_Contacts"></a>
Record Contacts</h2>
<p>Unlike Record Locations which tend to be internal units, Record Contacts are more commonly people or organizations that have a direct association with the record, and may be internal or external to the organization. Using the <code>AttachContact()</code> method, Content Manager allows each contact to be specifically identified as an Author, Addressee, Representative or Client. Other contact relationship types must use the generic type of ‘Other’.</p>
<h3><a class="anchor" id="autotoc_md139"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a> objContact2 = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Micro Focus&quot;</span>);</div>
<div class="line">objRec.AttachContact(objDB.CurrentUser, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a2cee2239b0324a42dea7cfd729807e58">ContactType</a>.Representative, <span class="keyword">true</span>);</div>
<div class="line">objRec.AttachContact(objContact2, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a2cee2239b0324a42dea7cfd729807e58">ContactType</a>.Client, <span class="keyword">true</span>);</div>
<div class="line">objRec.Save();</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a2cee2239b0324a42dea7cfd729807e58"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a2cee2239b0324a42dea7cfd729807e58">TRIM.SDK.ContactType</a></div><div class="ttdeci">ContactType</div><div class="ttdoc">Contact Types</div><div class="ttdef"><b>Definition:</b> ContactType.cs:16</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="Creating_a_Document"></a>
Creating a Document</h2>
<p>This scenario describes the general processes for using the SDK to create a record of a generic Record Type we are calling a ‘Document’.</p>
<p>While container files are usually created and maintained by specialist records managers, documents, on the other hand, are usually created by end-users, and require little specific metadata other than the identification of the appropriate container file to which the document belongs, as most other metadata and context is inherited from the container. A document record usually consists of an electronic object (the source document, image or other file), a unique identifier (which may be automatically generated by Content Manager), a record title and any other metadata required to profile and index the record, and a pointer to the container file from which the document derives its context.</p>
<p>The general steps for creating a new document record are as follows:</p>
<ol type="1">
<li>Instantiate the appropriate <code>RecordType</code> object</li>
<li>Instantiate a new <code>Record</code> object of this type</li>
<li>Identify the container file for the document</li>
<li>Set the free text title</li>
<li>Attach an electronic file</li>
<li>Assign the record’s Author or other contacts (optional)</li>
<li>Set Access Control to the electronic document (optional)</li>
<li>Assign other metadata or user-defined fields (optional)</li>
<li>Save the <code>Record</code> object</li>
</ol>
<h2><a class="anchor" id="Titling_and_numbering"></a>
Titling and numbering</h2>
<p>Titling for documents is generally straightforward – free text titling is the norm, and the title simply needs to succinctly describe the document or record. Record numbers may be assigned explicitly or they may be automatically generated – this is configured on the Record Type properties. If the number is explicitly assigned, the number (in expanded format) must be assigned to the <code>Record.LongNumber</code> property (it must be unique or the record will not be saved).</p>
<h3><a class="anchor" id="autotoc_md140"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div>
<div class="line">objRec.TypedTitle = <span class="stringliteral">&quot;Testing Long Numbers&quot;</span>;</div>
<div class="line">objRec.LongNumber = <span class="stringliteral">&quot;XK/008934&quot;</span>;</div>
<div class="line">objRec.Save();</div>
</div><!-- fragment --> <h2><a class="anchor" id="Assigning_to_a_container"></a>
Assigning to a container</h2>
<p>Although it is not compulsory, it is most common that an electronic record is logically assigned to a container file that represents the subject matter, case, client file or other contextual grouping relevant to the document.</p>
<p>To assign a record to a container, the existing container record must be instantiated (by Id or URI) and then passed as an argument to the (contained) record object’s <code>SetContainer()</code> method. The method includes a parameter for specifying whether the record is also ‘enclosed in’ the container, i.e. that the current location should reflect that it is with the container.</p>
<h3><a class="anchor" id="autotoc_md141"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType2 = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Folder&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objContainer = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType2);</div>
<div class="line">objRec.TypedTitle = <span class="stringliteral">&quot;Testing Long Numbers&quot;</span>;</div>
<div class="line">objRec.SetContainer(objContainer, <span class="keyword">true</span>);</div>
<div class="line">objRec.Save();</div>
</div><!-- fragment --> <h2><a class="anchor" id="Attaching_an_electronic_document"></a>
Attaching an electronic document</h2>
<p>Document records can represent physical paper documents, but usually they will include an electronic attachment, whether this is a word-processing document, scanned image or other type of file.</p>
<p>To attach an electronic document to a record, the file name and path must be used to instantiate an <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_input_document.html">InputDocument</a> object. This object is then passed as an argument to the record object’s <code>SetDocument()</code> method. The method includes parameters for specifying whether this should replace any existing document (or be added as a new revision), whether it should be marked as checked out to the current user, and any comments to be added to the record’s Notes field. The title of the document (minus the extension) becomes the title of the record by default.</p>
<h3><a class="anchor" id="autotoc_md142"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a> objRecType = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a9a91a6f03e7107a92af44bdd2092ca45a237bc42b2bd920bfb5e405bee26c8a36">RecordType</a>(objDB, <span class="stringliteral">&quot;Document&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> objRec = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, objRecType);</div>
<div class="line">InputDocument objDoc = <span class="keyword">new</span> InputDocument();</div>
<div class="line">objDoc.SetAsFile(<span class="stringliteral">@&quot;C:\temp\samples.txt&quot;</span>);</div>
<div class="line">objRec.SetDocument(objDoc, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="stringliteral">&quot;Created via SDK&quot;</span>);</div>
<div class="line">objRec.Save();</div>
</div><!-- fragment --> <h2><a class="anchor" id="Document_Author"></a>
Document Author</h2>
<p>Record Contacts are Content Manager location objects commonly representing people or organizations that have a direct association with the record. The most common type of Contact to be specified for an electronic document is the Author. Although the <code>AttachContact()</code> method can be used for this and other contact types, a shortcut is provided through the <code>Author</code> property. For examples how to do this, see the code examples for:</p><ul>
<li><a class="el" href="programming_guide.html#record_Location_info">Accessing record Location information</a></li>
<li><a class="el" href="programming_guide.html#modifying_properties">Modifying properties</a></li>
<li><a class="el" href="programming_guide.html#Record_Contacts">Record Contacts</a></li>
</ul>
<h1><a class="anchor" id="Locations"></a>
Locations</h1>
<h2><a class="anchor" id="Working_with_Locations"></a>
Working with Locations</h2>
<p>The <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_location.html">Location</a> object is an encapsulation of all properties and methods associated with Persons, Organizations, Positions and Groups. Locations can be identified by name or by URI, and can be selected on other criteria, such as date of birth, nicknames, or membership of a particular organization, role or group.</p>
<h2><a class="anchor" id="Finding_a_Person_by_Name"></a>
Finding a Person by Name</h2>
<p>Although the names of non-persons (Units, Positions and Organizations) must be unique, this is not the case for persons (Staff Names &amp; Contacts). However, Content Manager allows you to store a ‘nickname’ for any person, and this can be used as a substitute for a person’s name when searching. To find a particular person by name, you must pass the person’s combined name and title to the Location object’s constructor.</p>
<h3><a class="anchor" id="autotoc_md143"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a> objLoc = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Abbott, Peter (Mr)&quot;</span>);</div>
</div><!-- fragment --><p> If the sub-string does not uniquely identify a location (i.e. there are no matches, or there is more than one match) then a null object will be returned.</p>
<h2><a class="anchor" id="Creating_a_new_Staff_Member"></a>
Creating a new Staff Member</h2>
<p>To create a new staff member, you must instantiate a new location by calling the <code>Location</code>’s constructor. You then define the type of the location by assigning a value (in this case <code>Person</code>) to the <code>TypeOfLocation</code> property. You can then set various properties representing the person’s name, contact details such as telephone numbers and addresses, administrative details such as employee id numbers and so on.</p>
<p>If the new person is to be a Content Manager user, then there are login and security details to be provided. You will need to specify the user’s network login id and optionally an expiry date. For the security profile, you are required to either explicitly state the user’s security level (and optionally any Caveats) and a user category, or if role-based security is used, you can specify that the user takes the profile of a predefined group or user.</p>
<h3><a class="anchor" id="autotoc_md144"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a> objRole = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Executive&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a> objLoc = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a>(objDB);</div>
<div class="line">objLoc.TypeOfLocation = <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#aaa8df5a15f269e4fc4dec8e213ebba55">LocationType</a>.Person;</div>
<div class="line"><span class="comment">// Name</span></div>
<div class="line">objLoc.Surname = <span class="stringliteral">&quot;Evans&quot;</span>;</div>
<div class="line">objLoc.GivenNames = <span class="stringliteral">&quot;David&quot;</span>;</div>
<div class="line">objLoc.Initials = <span class="stringliteral">&quot;D&quot;</span>;</div>
<div class="line">objLoc.Honorific = <span class="stringliteral">&quot;Mr&quot;</span>;</div>
<div class="line"><span class="comment">// Personal &amp; Administrative</span></div>
<div class="line">objLoc.IsWithin = <span class="keyword">true</span>; <span class="comment">// Internal</span></div>
<div class="line">objLoc.IdNumber = <span class="stringliteral">&quot;793906&quot;</span>;</div>
<div class="line">objLoc.ReviewDate = <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a3bb14cd64ba102107ece7d22e656c1a2a8cf10d2341ed01492506085688270c1e">DateTime</a>.Today.AddYears(1);</div>
<div class="line">objLoc.DateOfBirth = <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a3bb14cd64ba102107ece7d22e656c1a2a8cf10d2341ed01492506085688270c1e">DateTime</a>.Parse(<span class="stringliteral">&quot;11/29/1976&quot;</span>);</div>
<div class="line">objLoc.PhoneNumber = <span class="stringliteral">&quot;555 123496&quot;</span>;</div>
<div class="line">objLoc.MobileNumber = <span class="stringliteral">&quot;+44 7939 062736&quot;</span>;</div>
<div class="line">objLoc.Notes = <span class="stringliteral">&quot;Created via SDK&quot;</span>;</div>
<div class="line"><span class="comment">// Login Details</span></div>
<div class="line">objLoc.CanLogin = <span class="keyword">true</span>;</div>
<div class="line">objLoc.LoginExpires = <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a3bb14cd64ba102107ece7d22e656c1a2a8cf10d2341ed01492506085688270c1e">DateTime</a>.Today.AddYears(3); <span class="comment">// Valid for 3 years</span></div>
<div class="line">objLoc.LogsInAs = <span class="stringliteral">&quot;evansd&quot;</span>; <span class="comment">// Network ID login</span></div>
<div class="line">                            <span class="comment">// Security</span></div>
<div class="line">objLoc.UseProfileOf = objRole;</div>
<div class="line"><span class="comment">// Confirm &amp; Save</span></div>
<div class="line"><span class="keywordflow">if</span> (objLoc.Verify(<span class="keyword">true</span>))</div>
<div class="line">{</div>
<div class="line">    objLoc.Save();</div>
<div class="line">    MessageBox.Show(objLoc.FormattedName + <span class="stringliteral">&quot; created.&quot;</span>);</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    MessageBox.Show(objLoc.ErrorMessage);</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_aaa8df5a15f269e4fc4dec8e213ebba55"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#aaa8df5a15f269e4fc4dec8e213ebba55">TRIM.SDK.LocationType</a></div><div class="ttdeci">LocationType</div><div class="ttdoc">Location Types</div><div class="ttdef"><b>Definition:</b> LocationType.cs:16</div></div>
</div><!-- fragment --><p> Relationships such as membership of units or reporting lines are created using the <code>AddRelationship()</code> method and passing parameters for the related location and the relationship type.</p>
<h3><a class="anchor" id="autotoc_md145"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a> objGroup = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Board of Directors&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a> objMember = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Evans, David (Mr)&quot;</span>);</div>
<div class="line">objMember.AddRelationship(objGroup, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a128206bbbf9f2b97c86ab9b354922447">LocRelationshipType</a>.MemberOf, <span class="keyword">true</span>);</div>
<div class="line">objMember.Save();</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a128206bbbf9f2b97c86ab9b354922447"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a128206bbbf9f2b97c86ab9b354922447">TRIM.SDK.LocRelationshipType</a></div><div class="ttdeci">LocRelationshipType</div><div class="ttdoc">Location Relationship Types</div><div class="ttdef"><b>Definition:</b> LocRelationshipType.cs:16</div></div>
</div><!-- fragment --><p> Addresses (including electronic addresses such as email or URL) are added by calling the <code>New()</code> method on the location’s <code>ChildAddresses</code> or <code>ChildEAddresses</code> collection properties.</p>
<h3><a class="anchor" id="autotoc_md146"></a>
Code Example</h3>
<div class="fragment"><div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a> objPerson = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ace5bf551379459c1c61d2a204061c455">Location</a>(objDB, <span class="stringliteral">&quot;Evans, David (Mr)&quot;</span>);</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a806e4d900157520fbb929a41329c8b97">LocationEAddress</a> objEmail = objPerson.ChildEAddresses.New();</div>
<div class="line">objEmail.ElectronicAddressData = <span class="stringliteral">&quot;evansd@gmail.com&quot;</span>;</div>
<div class="line">objEmail.ElectronicAddressType = <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#ab1d73a0580ea8a042bf0e4ce54014742">EAddressType</a>.Mail;</div>
<div class="line">objPerson.Save();</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650a806e4d900157520fbb929a41329c8b97"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a806e4d900157520fbb929a41329c8b97">TRIM.SDK.BaseObjectTypes.LocationEAddress</a></div><div class="ttdeci">@ LocationEAddress</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_ab1d73a0580ea8a042bf0e4ce54014742"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#ab1d73a0580ea8a042bf0e4ce54014742">TRIM.SDK.EAddressType</a></div><div class="ttdeci">EAddressType</div><div class="ttdoc">Electronic Address Types</div><div class="ttdef"><b>Definition:</b> EAddressType.cs:16</div></div>
</div><!-- fragment --> <h1><a class="anchor" id="Searching_Content_Manager"></a>
Searching Content Manager using the .NET SDK</h1>
<h2><a class="anchor" id="Searching_for_Records_Manager_objects"></a>
Searching for Content Manager objects</h2>
<p>One of the most powerful features of Content Manager is the wide range of search criteria that can be applied to select obects from the database. .NET SDK provides the <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html">TrimMainObjectSearch</a> class to provide this functionality. This class allows you to combine a number of search criteria together using boolean logic and then iterate through a resulting set of objects. Note that the <code>TrimMainObjectSearch</code> class can only be used to search for objects of a specified type, for instance, you can create a <code>TrimMainObjectSearch</code> to retrieve records. As its name implies, this class can be used to search for any SDK object that inherits from <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object.html">TrimMainObject</a>.</p>
<h3><a class="anchor" id="autotoc_md147"></a>
Code Example</h3>
<div class="fragment"><div class="line">TrimMainObjectSearch records = <span class="keyword">new</span> TrimMainObjectSearch(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record);</div>
<div class="line">records.SelectAll();</div>
</div><!-- fragment --> <h2><a class="anchor" id="Specifying_the_search_criteria"></a>
Specifying the search criteria</h2>
<p>The <code>TrimMainObjectSearch</code> class provides a number of simple "canned" methods for searching that do not involve any boolean logic. These are simple to use if you have a straightforward query, they include:</p><ul>
<li><code>SelectByPrefix()</code></li>
<li><code>SelectFavorites()</code></li>
<li><code>SelectByUserLabel()</code></li>
<li><code>SelectNone()</code></li>
<li><code>SelectAll()</code></li>
<li><code>SelectByUris()</code></li>
<li><code>SelectTopLevels()</code></li>
<li><code>SelectThoseWithin()</code></li>
</ul>
<p>To use the string search syntax available in Content Manager (refer to the Content Manager’s Help file for examples). There are three main components to a string search – the primary search string, a set of filters (these work as if they were combined with the primary search string using a boolean ‘and’) and the sort specification. To create a query in this way, you use the <code>SetSearchString()</code> method to specify the primary search string, and then you can optionally specify any filters using <code>SetFilterString()</code> and specify a sort using <code>AddSortItemAscending()</code>/<code>AddSortItemDescending()</code>. This approach is useful if you want to provide the user with a simple edit control for specifying a search, and is also very useful for web-based applications.</p>
<h3><a class="anchor" id="autotoc_md148"></a>
Code Example</h3>
<div class="fragment"><div class="line">TrimMainObjectSearch objSearch = <span class="keyword">new</span> TrimMainObjectSearch(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record);</div>
<div class="line">objSearch.SetSearchString(<span class="stringliteral">&quot;createdOn:this year and creator:me&quot;</span>);</div>
<div class="line">objSearch.SetFilterString(<span class="stringliteral">&quot;type:document&quot;</span>);</div>
<div class="line">objSearch.SetSortString(<span class="stringliteral">&quot;createdOn&quot;</span>);</div>
<div class="line">MessageBox.Show(objSearch.FastCount.ToString());</div>
</div><!-- fragment --><p> Another option is to work with <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_search_stack_item.html">TrimSearchStackItem</a> objects. The primary search criteria is represented internally as an array of <code>TrimSearchStackItem</code> objects, arranged as a reverse-polish stack to indicate operator precedence. A <code>TrimSearchStackItem</code> can be an operator (<a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_search_operator.html">TrimSearchOperator</a>) or a search clause (<a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_search_clause.html">TrimSearchClause</a>). You can build up a query using the internal search stack of the <code>TrimMainObjectSearch</code>, by using such methods as <code>AddSearchClause()</code>, <code>And()</code>, <code>Or()</code> and <code>Not()</code>.</p>
<p>A read of the Wikipedia article on Reverse Polish notation would be beneficial for developers unfamiliar with this style of expression. Because filters are all automatically "and-ed" together, they are simply represented as an array of <code>TrimSearchClause</code> items. For sorting, there is a <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_search_sort_item.html">TrimSearchSortItem</a> class and a corresponding array.</p>
<h3><a class="anchor" id="autotoc_md149"></a>
Code Example</h3>
<div class="fragment"><div class="line">TrimMainObjectSearch objSearch = <span class="keyword">new</span> TrimMainObjectSearch(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record);</div>
<div class="line">TrimSearchClause objClause1 = <span class="keyword">new</span> TrimSearchClause(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record,</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a753711ce2302f9a98b7fbca2c79cb33b">SearchClauseIds</a>.RecordCreatedOn);</div>
<div class="line">objClause1.SetCriteriaFromString(<span class="stringliteral">&quot;this year&quot;</span>);</div>
<div class="line">TrimSearchClause objClause2 = <span class="keyword">new</span> TrimSearchClause(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a753711ce2302f9a98b7fbca2c79cb33b">SearchClauseIds</a>.RecordCreator);</div>
<div class="line">objClause2.SetCriteriaFromString(<span class="stringliteral">&quot;me&quot;</span>);</div>
<div class="line">objSearch.AddSearchClause(objClause1);</div>
<div class="line">objSearch.AddSearchClause(objClause2);</div>
<div class="line">objSearch.And();</div>
<div class="line">TrimSearchClause objFilter = <span class="keyword">new</span> TrimSearchClause(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a753711ce2302f9a98b7fbca2c79cb33b">SearchClauseIds</a>.RecordType);</div>
<div class="line">objFilter.SetCriteriaFromString(<span class="stringliteral">&quot;document&quot;</span>);</div>
<div class="line">objSearch.AddFilterClause(objFilter);</div>
<div class="line">objSearch.AddSortItemAscending(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a753711ce2302f9a98b7fbca2c79cb33b">SearchClauseIds</a>.RecordCreatedOn);</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a753711ce2302f9a98b7fbca2c79cb33b"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a753711ce2302f9a98b7fbca2c79cb33b">TRIM.SDK.SearchClauseIds</a></div><div class="ttdeci">SearchClauseIds</div><div class="ttdoc">The SearchClauseIds enum</div><div class="ttdef"><b>Definition:</b> SearchClauseIds.cs:16</div></div>
</div><!-- fragment --><p> These individual classes provide extra features that allow even more elaborate queries to be built.</p>
<h2><a class="anchor" id="Retrieving_the_results"></a>
Retrieving the results of the search</h2>
<p>The <code>TrimMainObjectSearch</code> class derives from <code>IEnumerable</code> and thus you can use a standard <code>foreach</code> loop to retrieve items that match the selection. In addition, there are two methods that will return the search result as an array of unique object identifiers (corresponds to the <code>Uri</code> property of a <code>TrimMainObject</code>).</p>
<h3><a class="anchor" id="autotoc_md150"></a>
Code Example</h3>
<div class="fragment"><div class="line"><span class="keywordflow">foreach</span> (Record objRec <span class="keywordflow">in</span> objSearch)</div>
<div class="line">{</div>
<div class="line">    MessageBox.Show(objRec.Title);</div>
<div class="line">}</div>
</div><!-- fragment --> <h1><a class="anchor" id="Other_search_features"></a>
Other search features</h1>
<h2><a class="anchor" id="search_paged_results"></a>
Return paged results</h2>
<p>The <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_object_list_enumerator.html">TrimObjectListEnumerator</a> along with <code>TrimMainObjectSearch</code> support paged searching, typically used in web applications/services. The code below demonstrates getting the second page containing 20 results.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> pageSize = 20;</div>
<div class="line"><span class="keywordtype">int</span> skipPages = 1;</div>
<div class="line">TrimMainObjectSearch search = <span class="keyword">new</span> TrimMainObjectSearch(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record);</div>
<div class="line">search.SelectAll();</div>
<div class="line">search.OverrideBatchSize = pageSize;</div>
<div class="line">search.PagingMode = <span class="keyword">true</span>;</div>
<div class="line">search.SkipCount = skipPages * pageSize;</div>
<div class="line">var enumerator = search.GetEnumerator() as TrimObjectListEnumerator;</div>
<div class="line"><span class="keywordtype">int</span> counter = 0;</div>
<div class="line"><span class="keywordflow">while</span> (enumerator.MoveNext())</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (counter &gt;= pageSize)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a> record = enumerator.Current as <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>;</div>
<div class="line">    Console.WriteLine(record.Title);</div>
<div class="line">    counter++;</div>
<div class="line">}</div>
<div class="line">Console.WriteLine(enumerator.HasMore);</div>
</div><!-- fragment --> <h2><a class="anchor" id="enum_filtering"></a>
Filtering/searching by enum value</h2>
<p><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_search_clause.html">TrimSearchClause</a> contains the method <code>SetCriteriaFromEnumValueArray()</code> to support searching and filtering using enum values, as seen below.</p>
<div class="fragment"><div class="line">TrimSearchClause clause = <span class="keyword">new</span> TrimSearchClause(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a753711ce2302f9a98b7fbca2c79cb33b">SearchClauseIds</a>.RecordMedia);</div>
<div class="line">clause.SetCriteriaFromEnumValueArray&lt;<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a5686ab1a7c8b43b321c2bf6b46615ac1">MediaTypes</a>&gt;(<span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a5686ab1a7c8b43b321c2bf6b46615ac1">MediaTypes</a>[] { <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a5686ab1a7c8b43b321c2bf6b46615ac1">MediaTypes</a>.Paper });</div>
<div class="line">TrimMainObjectSearch search = <span class="keyword">new</span> TrimMainObjectSearch(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record);</div>
<div class="line">search.SetSearchString(<span class="stringliteral">&quot;unkAll&quot;</span>);</div>
<div class="line">search.AddFilterClause(clause);</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a5686ab1a7c8b43b321c2bf6b46615ac1"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a5686ab1a7c8b43b321c2bf6b46615ac1">TRIM.SDK.MediaTypes</a></div><div class="ttdeci">MediaTypes</div><div class="ttdoc">Media Types</div><div class="ttdef"><b>Definition:</b> MediaTypes.cs:16</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="Purpose_filtering"></a>
Purpose filtering</h2>
<p>You can specify that the items in the selection are eventually intended for a specific pupose. This may apply additional hidden filtering to the selection, although not always. As you are iterating through the results, you can use the <code>IsValidForPurpose()</code> method to test if the item is suitable for the purpose specified. Each <code>TrimMainObject</code> has a purpose enumeration associated with it – use this enumeration to specify suitable purpose values for the object you are selecting.</p>
<h2><a class="anchor" id="Persisting_a_search"></a>
Persisting a search</h2>
<p>The <code>TrimMainObjectSearch</code> class has a <code>SearchAsXML</code> property which will convert the search, filter and sort criteria to an XML string. This string is language-independent and is therefore useful if you wish to reuse the same search at some later stage, perhaps in a different locale.</p>
<h2><a class="anchor" id="autotoc_md151"></a>
Item matching</h2>
<p>The <code>TrimMainObjectSearch</code> class provides an <code>ItemMatches()</code> method, which allows you to test whether an existing <code>TrimMainObject</code> matches the search criteria contained within the search.</p>
<h2><a class="anchor" id="search_count"></a>
Result counts</h2>
<p>There are two search result count values, <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html#aa68abce05f1215936686b121a259348f">FastCount</a> and <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html#a96bb9e981f593581d59e9035b94f3720">Count</a>. <code>FastCount</code> may, in the case of the use of multiple levels of inherited ACLs, return -1 rather than an actual count. <code>Count</code> should always return a result accurate at the time it was called. <code>Count</code> will first try to use <code>FastCount</code>, if that fails it will fetch all the records and then loop through them to count them. So it will often be as fast as <code>FastCount</code> but may be a lot slower (especially for large result sets). So, use <code>FastCount</code> only when you need to avoid a slow response and can accept an invalid response.</p>
<h2><a class="anchor" id="sort_by_field"></a>
Sorting by User Defined Fields</h2>
<p>Although User Defined Fields are not indexed in the database, and thereby not part of the core sorting engine, it is still possible to sort using them. Always take care when doing this, as the lack of an index requires the entire result set to be fetched and sorted in memory. On large result sets this can be very slow. To sort using a User Defined field use either <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html#a7cd2f4cdda7510388d3002835cf480dc">GetEnumeratorSorted()</a> or <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_main_object_search.html#ae968894020bbaab4f42d694450cee934">GetResultAsUriArraySorted()</a>, as seen in this example:</p>
<div class="fragment"><div class="line">TrimMainObjectSearch search = <span class="keyword">new</span> TrimMainObjectSearch(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record);</div>
<div class="line">search.SelectAll();</div>
<div class="line">var enumerator = search.GetEnumeratorSorted(<span class="keyword">new</span> PropertyOrFieldDef(<span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a34d3d8ee3e60cdc3e6cd524705fdedba">FieldDefinition</a>(objDB, <span class="stringliteral">&quot;Speed&quot;</span>)), <span class="keyword">false</span>);</div>
<div class="line"><span class="keywordflow">while</span> (enumerator.MoveNext())</div>
<div class="line">{</div>
<div class="line">    Console.WriteLine(<span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6a0d9eaee314c567fd72fb97ee707a36">Record</a>(objDB, (TrimURI)enumerator.Current).Title);</div>
<div class="line">}</div>
</div><!-- fragment --> <h1><a class="anchor" id="stream_search"></a>
Stream searching</h1>
<p><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_search_data_stream.html">TrimSearchDataStream</a> provides a simplified search capability that bypasses, among other things, the SDK internal caching to provide a faster response time for simple searches. Stream search is limited to record searching and returns a JSON string rather than an enumeration of <code>Record</code> objects, not all properties are supported, use <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_search_data_stream.html#a5b507cedf9654c4b6018fdf5f0cb71d4">IsPropertyOrFieldSupported</a> or the <a class="el" href="property_defs.html#property_definitions_Record">property documentation</a> to check whether a property is supported.</p>
<h2><a class="anchor" id="example_stream_search"></a>
Example</h2>
<p>In the code below the search stream is used to find all electronic documents, returning the RecordTitle. Each record is returned as a JSON string which we de-serialize using the .Net DataContract de-serializer.</p>
<div class="fragment"><div class="line">[DataContract]</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>TrimProperty</div>
<div class="line">{</div>
<div class="line">    [DataMember]</div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">string</span> Value { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line">}</div>
<div class="line">[DataContract]</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>TrimRecord</div>
<div class="line">{</div>
<div class="line">    [DataMember]</div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">long</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a6e8c23accbbfd81493674ded41e2e7b7a3840cd8f73026713059f0ed0562c5493">Uri</a> { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line">    [DataMember]</div>
<div class="line">    <span class="keyword">public</span> TrimProperty <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#ac89cda7c5437633dc79a88c21e468394a6553c8a472fdb511d620483ec19c0eec">RecordTitle</a> { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a6e8c23accbbfd81493674ded41e2e7b7a3840cd8f73026713059f0ed0562c5493"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a6e8c23accbbfd81493674ded41e2e7b7a3840cd8f73026713059f0ed0562c5493">TRIM.SDK.ExternalLinkSpecialParameters.Uri</a></div><div class="ttdeci">@ Uri</div><div class="ttdoc">Object Uri</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_ac89cda7c5437633dc79a88c21e468394a6553c8a472fdb511d620483ec19c0eec"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#ac89cda7c5437633dc79a88c21e468394a6553c8a472fdb511d620483ec19c0eec">TRIM.SDK.PropertyIds.RecordTitle</a></div><div class="ttdeci">@ RecordTitle</div><div class="ttdoc">Title</div></div>
</div><!-- fragment --><div class="fragment"><div class="line">TrimSearchDataStream stream = <span class="keyword">null</span>;</div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">    TrimMainObjectSearch search = <span class="keyword">new</span> TrimMainObjectSearch(objDB, <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.Record);</div>
<div class="line">    search.SetSearchString(<span class="stringliteral">&quot;recElectronic&quot;</span>);</div>
<div class="line">    stream = search.GetDataStream(<span class="keyword">new</span> PropertyOrFieldDefList() { <span class="keyword">new</span> PropertyOrFieldDef(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#ac89cda7c5437633dc79a88c21e468394">PropertyIds</a>.RecordTitle, objDB) });</div>
<div class="line">    <span class="keywordflow">while</span> (stream.MoveNext())</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">string</span> json = stream.Current().GetAsJSONString();</div>
<div class="line">        var serializer = <span class="keyword">new</span> DataContractJsonSerializer(typeof(TrimRecord));</div>
<div class="line">        TrimRecord record = (TrimRecord)serializer.ReadObject(<span class="keyword">new</span> MemoryStream(Encoding.UTF8.GetBytes(json)));</div>
<div class="line">        Console.WriteLine($<span class="stringliteral">&quot;{record.RecordTitle.Value} --- {record.Uri}&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">finally</span></div>
<div class="line">{</div>
<div class="line">    <span class="comment">// ensure the stream is released when finished to prevent memory leaks</span></div>
<div class="line">    <span class="keywordflow">if</span> (stream !=<span class="keyword">null</span>)</div>
<div class="line">    {</div>
<div class="line">        stream.Release();</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="example_stream_search_json"></a>
Sample JSON</h2>
<p>The primary audience of <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_search_data_stream.html">TrimSearchDataStream</a> is the web service, which is why the response is JSON formatted to match the web service data.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;TrimType&quot;: &quot;Record&quot;,</div>
<div class="line">    &quot;Uri&quot;: 9000000246,</div>
<div class="line">    &quot;RecordTitle&quot;: {</div>
<div class="line">        &quot;Value&quot;: &quot;Question regarding the installation and setup of ContextWeb&quot;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="document_integrity_checker"></a>
Document integrity checker</h1>
<p>The document store integrity check can now be executed from the SDK. The following class and enum are introduced for the document store checker:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Name    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Class   </td><td class="markdownTableBodyNone"><a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_document_store_integrity_check_task.html">DocumentStoreIntegrityCheckTask</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Enum   </td><td class="markdownTableBodyNone"><a class="el" href="namespace_t_r_i_m_1_1_s_d_k.html#a6688581b60dea6b8108117df844d0bc3">DocumentStoreIntegrityCheckCounter</a>   </td></tr>
</table>
<h2><a class="anchor" id="example_running_document_store_integrity_check"></a>
Example: Running Document Store Integrity Check</h2>
<div class="fragment"><div class="line"><span class="keywordtype">string</span> m_workPath = <span class="stringliteral">&quot;C:\\tmp&quot;</span>;</div>
<div class="line">db = <span class="keyword">new</span> <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a>();</div>
<div class="line">db.Id = dbId;</div>
<div class="line">db.WorkgroupServerName = <span class="stringliteral">&quot;workgroupserver&quot;</span>;</div>
<div class="line">db.WorkgroupServerPort = 1137;</div>
<div class="line">db.Connect();</div>
<div class="line"><a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6bfdc91bc041aaf54fd7b721fcb2c239">ElectronicStore</a> storeToCheck = (<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6bfdc91bc041aaf54fd7b721fcb2c239">ElectronicStore</a>)db.FindTrimObjectByName(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.ElectronicStore, <span class="stringliteral">&quot;Main Document Store&quot;</span>);</div>
<div class="line">task = <span class="keyword">new</span> DocumentStoreIntegrityCheckTask(storeToCheck);</div>
<div class="line">task.FixErrors = <span class="keyword">true</span>; <span class="comment">//Set this to true if you want the checker to correct any error.</span></div>
<div class="line">task.LogPath = m_workPath + <span class="stringliteral">&quot;/StoreChecker.log&quot;</span>; <span class="comment">//The path where the checker&#39;s log will be written to</span></div>
<div class="line"><span class="keywordflow">try</span></div>
<div class="line">{</div>
<div class="line">    task.Run();</div>
<div class="line">    <span class="comment">//If you want to get a counter for a number of corrupted document</span></div>
<div class="line">    task.GetProgressCounter(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a6688581b60dea6b8108117df844d0bc3">DocumentStoreIntegrityCheckCounter</a>.CorruptedDocuments);</div>
<div class="line">    <span class="comment">//If you want to cancel the check</span></div>
<div class="line">    task.Cancel();</div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">catch</span> (TrimException trimException)</div>
<div class="line">{</div>
<div class="line">    Debug.Print(trimException.Message);</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a03fe8e34db7010985558027db56c8650a6bfdc91bc041aaf54fd7b721fcb2c239"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650a6bfdc91bc041aaf54fd7b721fcb2c239">TRIM.SDK.BaseObjectTypes.ElectronicStore</a></div><div class="ttdeci">@ ElectronicStore</div></div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a6688581b60dea6b8108117df844d0bc3"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a6688581b60dea6b8108117df844d0bc3">TRIM.SDK.DocumentStoreIntegrityCheckCounter</a></div><div class="ttdeci">DocumentStoreIntegrityCheckCounter</div><div class="ttdoc">Document Store Integrity Check Counter Types</div><div class="ttdef"><b>Definition:</b> DocumentStoreIntegrityCheckCounter.cs:16</div></div>
</div><!-- fragment --> <h1><a class="anchor" id="change_notifications"></a>
Global object change notifications</h1>
<p>The <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_trim_object_change_notifier.html">TrimObjectChangeNotifier</a> class provides a global notification mechanism for when Content Manager business objects are changed. The notifications specify the object type and the object URI of the changed object, and allows the recipient to take relevant actions, such as refreshing cached objects. A common use case is to notify client-side code when a cached object has been modified by some other process in the system.</p>
<h2><a class="anchor" id="example_change_notifications"></a>
Example</h2>
<p>The following code:</p>
<ol type="1">
<li>creates (and disposes) a database connection to ensure there is a connection to the workgroup server. This would probably be unnecesary in a production app as you would already have a connected <code>Database</code>.</li>
<li>creates a <code>TrimObjectChangeNotifier</code> class to monitor changes to <code>RecordType</code> objects.</li>
<li>writes a line to the console each time a <code>RecordType</code> object changes.</li>
</ol>
<div class="fragment"><div class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">void</span> Notifier_OnTrimObjectChange(TrimObjectChangeList changeList)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">foreach</span> (var change <span class="keywordflow">in</span> changeList)</div>
<div class="line">    {</div>
<div class="line">        System.Console.WriteLine(<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a08dc09b7f3f64f99ce845ddf6546204aa27118326006d3829667a400ad23d5d98">String</a>.Format(</div>
<div class="line">            <span class="stringliteral">&quot;Received TRIM object change notification. Object type: {0}, Object uri: {1}&quot;</span>,</div>
<div class="line">            change.ObjectType,</div>
<div class="line">            change.ObjectUri));</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"><span class="keyword">private</span> <span class="keywordtype">void</span> StartNotifications()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using</span> (<a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650ae307db07b3975fef922a80d07455ee5e">Database</a> db = getDatabase(<span class="stringliteral">&quot;[A USER]&quot;</span>))</div>
<div class="line">    {</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>[] objectTypes = { <a class="code" href="namespace_t_r_i_m_1_1_s_d_k.html#a03fe8e34db7010985558027db56c8650">BaseObjectTypes</a>.RecordType };</div>
<div class="line">    <span class="keyword">using</span> (TrimObjectChangeNotifier notifier = <span class="keyword">new</span> TrimObjectChangeNotifier(<span class="stringliteral">&quot;M1&quot;</span>, objectTypes))</div>
<div class="line">    {</div>
<div class="line">        notifier.OnTrimObjectChange += Notifier_OnTrimObjectChange;</div>
<div class="line">        notifier.Start();</div>
<div class="line">        Console.ReadKey();</div>
<div class="line">        notifier.Stop();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="anamespace_t_r_i_m_1_1_s_d_k_html_a08dc09b7f3f64f99ce845ddf6546204aa27118326006d3829667a400ad23d5d98"><div class="ttname"><a href="namespace_t_r_i_m_1_1_s_d_k.html#a08dc09b7f3f64f99ce845ddf6546204aa27118326006d3829667a400ad23d5d98">TRIM.SDK.DateSearchType.String</a></div><div class="ttdeci">@ String</div><div class="ttdoc">Any valid date search string expression</div></div>
</div><!-- fragment --> <h1><a class="anchor" id="wgs_progress_notifications"></a>
Progress notifications while communicating with a workgroup server</h1>
<p>The <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_wgs_progress_notifier.html">WgsProgressNotifier</a> class provides SDK applications with progress notifications while the SDK is making network calls to a workgroup server. This allows an interactive SDK application to provide ongoing progress feedback to the user, and also allows the current workgroup server operation to be canceled. For more information, please refer to the class documenation for <a class="el" href="class_t_r_i_m_1_1_s_d_k_1_1_wgs_progress_notifier.html">WgsProgressNotifier</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
